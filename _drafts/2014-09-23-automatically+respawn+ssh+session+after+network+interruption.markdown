---
layout: post
title:  "Забываем про обрывы связи при работе с SSH"
date:   2014-09-23 
tags: ssh mosh autossh
categories: article
---

## autossh ##

Существует большое кол-во решений для комфортной работы с SSH в условиях плохого интернета (либо после выхода из suspend), но самым доступным и не требующим никакого дополнительного ПО на серверной стороне является autossh ([http://www.harding.motd.ca/autossh/](http://www.harding.motd.ca/autossh/)). Его достаточно поставить на свою клиентскую машину и прописать алиас в шелле:

```bash
alias ssh="autossh"
```

и каждый раз при разрыве связь будет возобновляться.

## mosh ##

Ещё более интересным вариантом является mosh ([https://mosh.mit.edu/](https://mosh.mit.edu/)). 

Он помимо основной рассматриваемой темы умеет:

* Игнорировать смену вашего IP-адреса (особенно актуально если вы сидите по SSH с мобильного интернета перемещаясь, или вы после суспенда ноутбука очутились в другом месте)
* Реагировать на нажатие Ctrl+C (теперь если вы выполните случайно `cat большой_бинарный_файл` - эта комбинация сработает)
* Весь вводимый текст вводится на стороне клиента и отправляется на сервер лишь при нажатии Enter (то есть никаких тормозов при вводе даже если канал очень плохой не будет)
* Работает поверх SSH и никакой аутентификацией не занимается, а значит безопасен.

Но есть и минусы, хоть и не значительные:

* На сервере тоже должен быть установлен mosh и запущен процесс **mosh-server** (но не требует root и может быть запущен от любого пользователя)
* Использует порты 60000–61000 (а значит на фаерволле они должны быть открыты)

Пользоваться mosh очень просто. На сервере запускаем под любым пользователем:

```
$ mosh-server
```

На клиенте используем команду **mosh** с синтаксисом утилиты **ssh**, например:

```
mosh user@host -p2222
```

